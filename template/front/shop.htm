{template common/header_ajax}
<script type="text/javascript" reload=1>
(function(){
	jq('#ulmenu li').each(function(){
		jq(this).click(function(){
			jq(this).css('background','url(source/plugin/gfarm/img/ui/select.png) no-repeat').children('a').css('color','white').addClass('acolor');
			jq(this).siblings().css('background','url(source/plugin/gfarm/img/ui/noselect.png) no-repeat').children('a').css('color','#934f13').removeClass('acolor');
		});		
	});
	var left=jq('#fwin_gfarm').offset().left;
	var top=jq('#fwin_gfarm').offset().top;	
	jq('#ul2 li').each(function(){
		var lileft=this.offsetLeft,litop=this.offsetTop;
		jq(this).find('.showimg').hover(function(){
			var st=litop-jq('#ins').scrollTop();
			jq(this).parents('li').find('.shopattr').css({'left':left+lileft+70+'px','top':top+st+140+'px'}).show();		
		},function(){
			jq(this).parents('li').find('.shopattr').hide();
		});
	});
})();
</script>
<style>
#fwin_gfarm .m_c{background:url(source/plugin/gfarm/img/ui/bg-big.png) no-repeat;}
</style>
<iframe id="myframe" name="myframe" style="display:none"></iframe>
<div class='shopclass' onmousedown="dragMenu($('fwin_gfarm'),event,1)">
<img src='source/plugin/gfarm/img/ui/shopt.png' class='shoptitle'/>
<div class='shopclose' onclick="hideWindow('gfarm1');hideWindow('gfarm');"></div>
<ul class='line listti' id='ulmenu'>
	<li style='background:url(source/plugin/gfarm/img/ui/select.png) no-repeat'><a href='javascript:;' style="color: white;" class='acolor' onclick="ajaxget('plugin.php?id=gfarm:front&mod=shop&act=ajax&do=9','outs')">{lang gfarm:c031}</a></li>
	<li><a href='javascript:;' onclick="ajaxget('plugin.php?id=gfarm:front&mod=shop&act=ajax&do=19','outs')">{lang gfarm:f015}</a></li>
	{if $cequipment=='1'}
	<li><a href='javascript:;' onclick="ajaxget('plugin.php?id=gfarm:front&mod=shop&act=ajax&do=1','outs')">{lang gfarm:f125}</a></li>
	<li><a href='javascript:;' onclick="ajaxget('plugin.php?id=gfarm:front&mod=shop&act=ajax&do=4','outs')">{lang gfarm:f126}</a></li>
	{/if}
	{if $cformula=='1'}
	<li><a href='javascript:;' onclick="ajaxget('plugin.php?id=gfarm:front&mod=shop&act=ajax&do=13','outs')">{lang gfarm:f129}</a></li>
	{/if}
</ul>
<div id='outs'>
<div id='ins'>
	<ul class='line' id='ul2'>
	<!--{loop $shopInfos $key=>$val}-->
	<li>
		<div class="shopbottom listti">
			<span class='shopname'>{$val['name']}</span>
			{if $tshop[$key]}<span id='{$val[id]}' class='buybotton' onclick="openWS(this)">{lang gfarm:f134}</span>{/if}
		</div>
			<div style="padding-top: 10px">
			<div style="float: left;width: 75px;text-align: center;position: relative;">
			<img class='showimg' src="{$val['img']}"/>			
			<span>LV.{$val['use_level']}</span>
			</div>
			<div style="float: left;text-align: left;">{lang gfarm:f074}{lang gfarm:c062}{if $val['money_typeb']==1}<img title="{$config['bullionsname']}" src="source/plugin/gfarm/img/ui/gold-1.png">{else}<img title="{$config['moneyname']}" src="source/plugin/gfarm/img/ui/money-1.png">{/if}{$val['buy_price']}<br/>
			{lang gfarm:f075}{lang gfarm:c062}<span id='still_{$val[id]}'>{if !empty($val['add_date'])}{$goodupdates[$key]['still_num']}{else}{lang gfarm:c144}{/if}</span><br/>
			{if empty($do)||$do=='9'}{lang gfarm:f076}{lang gfarm:c062}{$datas[$key]['mature_time']}{lang gfarm:f077}{/if}
			</div>			
			</div>
			<div class='shopattr'>
				<div>
				<img style="float:left;" src="{$val['img']}" width="40px"/>
				<div style="float: left;width: 85px;line-height: 15px;margin-left:5px">
				<span style="text-align: center;">{$val['name']}</span><br/>
				{lang gfarm:f078}{lang gfarm:c062}{$separates[$key]['separate_name']}<br/>
				{lang gfarm:c102}{lang gfarm:c062}{$val['use_level']}{lang gfarm:f016}<br/>
				</div>
				</div>
				<div style="clear: both">
				{lang gfarm:c073}{lang gfarm:c062}{$val['use_benevolence']}<br/>
				{lang gfarm:c049}{lang gfarm:c062}{$datas[$key]['mature_time']}{lang gfarm:f077}<br/>
				{lang gfarm:c051}{lang gfarm:c062}{$datas[$key]['experience']}<br/>		
				{$val['description']}
				</div>
			</div>
	</li>
	<!--{/loop}-->
	</ul>
	</div>
	<div id=shopscrollbartop></div>
	<div id='shopscrollBars'>
	<div id='shophandles'></div>
	</div>
	<div id='shopscrollbarbottom'></div>	
</div>
<!--  <div id='shopallnum'>{lang gfarm:f079}<span id='shopbottom'>{eval echo count($shopInfos)}{lang gfarm:f119}{lang gfarm:c031}</span>{lang gfarm:f080}</div>-->
</div>
<script type="text/javascript">
	function clo_window()
	{
		parent.window.hideWindow('gfarm');
	}
	function showerror(msg) {
		window.showDialog(msg, 'error', '', function() {}, 0);
	}
	function showsajax(msg,para,money,flag,id,still_num,tflag,edflag) {
		window.showDialog(msg, 'right', '', function() {
			if(flag=='1'){
				jq('#useryuan').html(money);
			}else{
				jq('#usermoney').html(money);
			}		
			if(edflag!=1){
				if(tflag==1){
					jq('#still_'+id).html(still_num);
				}else{
					jq('#still_'+id).html('{lang gfarm:c144}');
				}	
			}else{
				jq('#'+id).removeAttr('onclick').html('{lang gfarm:f081}');
			}					
		}, 0);
	}
	function openWS(obj){
		window.showWindow('gfarm1','plugin.php?id=gfarm:front&mod=shop&act=showgoods&goodid='+jq(obj).attr('id'));
	}
</script>
<script reload=1>
var ximen = {
	$:function(o){ return document.getElementById(o); },
	getStyle:function(o) { return o.currentStyle||document.defaultView.getComputedStyle(o,null); },
	getOffset:function(o) {
		var t = o.offsetTop,h = o.offsetHeight;
		while(o = o.offsetParent) { t += o.offsetTop; }
		return { top:t, height:h };
	},
	bind:function(o,eType,fn) {
		if(o.addEventListener) { o.addEventListener(eType,fn,false); }
		else if(o.attachEvent) { o.attachEvent("on" + eType,fn); }
		else { o["on" + eType] = fn; }
	},
	unbind:function(o,eType,fn) {
		if(o.removeEventListener) { o.removeEventListener(eType,fn,false); }
		else if(o.detachEvent) { o.detachEvent("on" + eType,fn); }
		else { o["on" + eType] = fn; }
	},
	stopPropagate:function(e) {
		if(e && e.stopPropagation) { e.stopPropagation(); } 
		else { window.event.cancelBubble = true; }
		return false;
	},
	stopDefault:function(e) {
		e = e || window.event;
		e.stopPropagation && (e.preventDefault(),e.stopPropagation()) || (e.cancelBubble = true,e.returnValue = false);
	}
};
(function(){
	var myScrollDown,myScrollUp,scrollBarMouseDown,scrollBarMouseUp,relY,
		out = ximen.$("outs"),
		content = ximen.$("ins"),
		scrollBar = ximen.$("shopscrollBars"),
		scrollBarHandle = ximen.$("shophandles"),
		contentScrollHeight = content.scrollHeight,//灏哻ontent.scrollHeight璧嬩竴娆″�,瑙ｅ喅IE6涓媠crollHeight闇�皟鐢ㄤ袱娆＄殑bug
		scrollBarHandleHeight = parseInt(content.offsetHeight/content.scrollHeight * scrollBar.offsetHeight),
		setScrollBarHandle = function() {//褰撳唴瀹硅秴澶氭椂璁剧疆鎷栨嫿鏉″瓙鐨勬渶灏忛珮搴�
		if(scrollBarHandleHeight==scrollBar.offsetHeight){scrollBar.style.display='none';jq('#shopscrollbartop').hide();jq('#shopscrollbarbottom').hide();}
		else { scrollBarHandleHeight = 20; scrollBarHandle.style.height = "20px"; jq('#shopscrollbartop').show();jq('#shopscrollbarbottom').show();}
		},
		clearAllInterval = function() { clearInterval(myScrollDown); clearInterval(myScrollUp); clearInterval(scrollBarMouseDown); },
		forMousemove = function(e) {
			var e = e || window.event;
			content.scrollTop = (e.clientY - relY)/(scrollBar.offsetHeight - scrollBarHandleHeight)*(content.scrollHeight - content.offsetHeight);
		},
		forMouseDown = function(event){
			var et = event.target || event.srcElement;//target鐏嫄srcElementIE		
			relY = event.clientY - et.offsetTop;
			ximen.bind(document,"mousemove",forMousemove);
		},
		scrollDir = function(e) {
			var e = e || window.event,eDir;					//璁剧疆婊氳疆浜嬩欢,e.wheelDelta涓巈.detail鍒嗗埆鍏煎IE銆乄3C锛屾牴鎹繑鍥炲�鐨勬璐熸潵鍒ゆ柇婊氬姩鏂瑰悜
			if(e.wheelDelta) { eDir = e.wheelDelta/120; }
			else if(e.detail) { eDir = -e.detail/3; }
			if(eDir > 0) { content.scrollTop -= 80; }	//姝ラ暱璁�0鍍忕礌a姣旇緝鎺ヨ繎window婊氬姩鏉＄殑婊氬姩閫熷害
			else { content.scrollTop += 80; }
			ximen.stopDefault(e);
		};
	setScrollBarHandle();
	ximen.bind(content,"scroll",function(){
		scrollBarHandle.style.top = content.scrollTop/(content.scrollHeight - content.offsetHeight) * (scrollBar.offsetHeight - scrollBarHandleHeight)+ "px";
	});
	ximen.bind(scrollBarHandle,"mousedown",forMouseDown);
	ximen.bind(document,"mouseup",function(){
		ximen.unbind(document,"mousemove",forMousemove);
		ximen.unbind(scrollBarHandle,"mousemove",forMousemove);
	});
	ximen.bind(out,"selectstart",function(){ return false; });
	ximen.bind(out,"select",function(){ document.selection.empty(); });
	ximen.bind(out,"mousewheel",scrollDir);
	ximen.bind(out,"DOMMouseScroll",scrollDir);
	jq('#shopscrollbarbottom').click(function(){
		content.scrollTop += contentScrollHeight;
	});
	jq('#shopscrollbartop').click(function(){
		content.scrollTop -= contentScrollHeight;
	});
})();
</script>
{template common/footer_ajax}